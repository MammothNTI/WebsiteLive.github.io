<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Login & Signup System</title>
    <style>
        body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #f3f3f3; }
        .container { text-align: center; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        input { margin: 10px 0; padding: 10px; width: 100%; }
        button { padding: 10px; width: 100%; background-color: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h2 id="form-title">Signup</h2>
        <div id="message"></div>
        <form id="auth-form">
            <input type="text" id="username" placeholder="Username" required>
            <input type="password" id="password" placeholder="Password" required>
            <button type="button" onclick="handleAuth()">Submit</button>
        </form>
        <p id="toggle-link" onclick="toggleForm()">Already have an account? Login here</p>
    </div>

    <script src="https://unpkg.com/kvdb.io@v1.0"></script>
    <script>
        // Initialize KVdb storage
        const kvdbStorage = KVdb.bucket('javascript').localStorage();

        // Flag for login/signup toggle
        let isLogin = false;

        // Toggle between login and signup
        function toggleForm() {
            isLogin = !isLogin;
            document.getElementById('form-title').textContent = isLogin ? 'Login' : 'Signup';
            document.getElementById('toggle-link').textContent = isLogin 
                ? "Don't have an account? Signup here" 
                : "Already have an account? Login here";
            document.getElementById('message').textContent = '';
        }

        // Handle authentication (login or signup)
        function handleAuth() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();

            if (isLogin) {
                // Login
                kvdbStorage.getItem(username)
                    .then(storedPassword => {
                        if (storedPassword && storedPassword === password) {
                            document.getElementById('message').textContent = 'Login successful!';
                            document.getElementById('message').style.color = 'green';
                        } else {
                            document.getElementById('message').textContent = 'Invalid username or password';
                            document.getElementById('message').style.color = 'red';
                        }
                    })
                    .catch(err => {
                        document.getElementById('message').textContent = 'Error occurred';
                        document.getElementById('message').style.color = 'red';
                    });
            } else {
                // Signup
                kvdbStorage.getItem(username)
                    .then(storedPassword => {
                        if (storedPassword) {
                            document.getElementById('message').textContent = 'Username already exists';
                            document.getElementById('message').style.color = 'red';
                        } else {
                            kvdbStorage.setItem(username, password)
                                .then(() => {
                                    document.getElementById('message').textContent = 'Signup successful!';
                                    document.getElementById('message').style.color = 'green';
                                })
                                .catch(err => {
                                    document.getElementById('message').textContent = 'Error saving data';
                                    document.getElementById('message').style.color = 'red';
                                });
                        }
                    })
                    .catch(err => {
                        document.getElementById('message').textContent = 'Error occurred';
                        document.getElementById('message').style.color = 'red';
                    });
            }
        }
    </script>
</body>
</html>
